<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Eva & Akhil â¤ï¸</title>

<style>
html,body{height:100%}
body{
  margin:0;min-height:100vh;background:#ffe6f0;font-family:Arial,sans-serif;
  overflow:auto;-webkit-overflow-scrolling:touch;
  opacity:0;transition:opacity 1.2s ease;
}
body.loaded{opacity:1}
#sparkles{position:fixed;inset:0;pointer-events:none;z-index:50}

.wrap{
  min-height:100vh; display:flex; align-items:flex-start; justify-content:center; padding:24px;
}
.card{
  background:white;width:min(560px,92vw);padding:26px;border-radius:22px;
  box-shadow:0 18px 55px rgba(0,0,0,.15);text-align:center;position:relative;z-index:2;
  margin:18px 0 60px;
}
.type{font-size:22px;font-weight:800;color:#c2255c;min-height:64px;margin:0 0 10px}
button,select{border:0;border-radius:14px;padding:10px 14px;font-weight:800;cursor:pointer}
.openBtn{background:#ff5c8a;color:white;box-shadow:0 10px 25px rgba(255,92,138,.35)}
.madBtn{background:#adb5bd;color:white;margin-top:10px}
.madBtn.love{background:#ff5c8a}
.smallBtn{background:#fff0f6}
.smallBtn:active{transform:translateY(1px)}

.heartbeat{animation:beat 1.2s infinite}
@keyframes beat{0%,100%{transform:scale(1)}25%{transform:scale(1.04)}50%{transform:scale(1)}75%{transform:scale(1.04)}}

.hint{display:block;margin-top:6px;opacity:.65}
#timeMsg{margin:6px 0 0;color:#555}

#dailyQuote{margin:10px 0 0;color:#555;background:#fff0f6;border-radius:14px;padding:10px}
#dailyQuote b{color:#c2255c}

.row{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;align-items:center;margin-top:12px}
.pill{display:inline-block;background:#fff0f6;border-radius:999px;padding:8px 12px;font-weight:800;color:#c2255c}

.heart{position:fixed;z-index:40;pointer-events:none;font-size:18px;filter:drop-shadow(0 6px 10px rgba(0,0,0,.12));animation:floatUp linear forwards}
@keyframes floatUp{from{transform:translate(-50%,0);opacity:0}10%{opacity:1}to{transform:translate(-50%,-110vh);opacity:0}}

.envelope{display:none;margin:16px auto 0;width:320px;height:210px;position:relative}
.envelope.show{display:block}
.paper{position:absolute;left:50%;bottom:12px;transform:translateX(-50%) translateY(80px);
  width:86%;background:white;border-radius:14px;padding:16px;transition:.7s;
  box-shadow:0 12px 30px rgba(0,0,0,.18)
}
.flap{position:absolute;inset:0;background:linear-gradient(135deg,#ff85a2,#ff4d6d);
  clip-path:polygon(0 0,100% 0,50% 55%);transform-origin:top;transition:.7s;
  border-radius:18px;box-shadow:inset 0 -10px 30px rgba(255,255,255,.25)
}
.envelope::before{content:"";position:absolute;inset:0;border-radius:18px;
  background:linear-gradient(135deg,#ffd1dc,#ffb3c6);
  clip-path:polygon(0 0,100% 0,100% 100%,50% 70%,0 100%);
}
.envelope.open .flap{transform:rotateX(180deg)}
.envelope.open .paper{transform:translateX(-50%) translateY(-6px)}

.secret{display:none;margin-top:10px;padding:10px;background:#fff0f6;border-radius:12px}
.secret.show{display:block}

#countdownBox{margin-top:14px;padding:12px;border-radius:14px;background:#fff0f6}
#crMeme{display:none;width:120px;margin:10px auto;border-radius:12px}

.timeline{margin-top:14px;text-align:left;background:#fff0f6;border-radius:16px;padding:12px}
.timeline h3{margin:0 0 8px;color:#c2255c}
.tItem{display:flex;gap:10px;align-items:flex-start;margin:8px 0}
.dot{width:10px;height:10px;border-radius:50%;background:#ff5c8a;margin-top:5px;flex:0 0 auto}
.tText{color:#444}

.shineBox{margin-top:14px;text-align:left;position:relative;overflow:hidden;
  background:linear-gradient(135deg,#fff0f6,#ffe6f0);
  border-radius:16px;padding:12px;
  box-shadow:0 10px 25px rgba(0,0,0,.06)
}
.shineBox::after{content:""; position:absolute; top:-40%; left:-60%; width:60%; height:180%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.7),transparent);
  transform:rotate(20deg);
  animation:shine 2.8s infinite;
}
@keyframes shine{0%{left:-80%}100%{left:140%}}
.shineBox h3{margin:0 0 8px;color:#c2255c}
.shineBox ul{margin:0;padding-left:18px;color:#444}
.small{font-size:13px;color:#666;margin-top:6px}

.sideLetters{position:fixed; right:12px; top:110px; z-index:80;display:flex; flex-direction:column; gap:10px;}
.sideBtn{background:#ff5c8a; color:white; border-radius:999px;padding:10px 12px; font-weight:900; box-shadow:0 10px 25px rgba(255,92,138,.35);}
.sideBtn:active{transform:translateY(1px)}
@media (max-width:420px){.sideLetters{right:8px; top:90px}.sideBtn{padding:9px 10px; font-size:13px}}

.drawerOverlay{position:fixed; inset:0; background:rgba(0,0,0,.25);display:none; z-index:90;}
.drawerOverlay.show{display:block}
.drawer{position:fixed; top:0; right:0; height:100%; width:min(420px,92vw);transform:translateX(110%); transition:transform .25s ease;
  z-index:100; padding:18px 14px 18px; display:flex; flex-direction:column; gap:10px;}
.drawer.show{transform:translateX(0)}
.scrollCard{background:linear-gradient(180deg,#fff7fb,#ffe6f0);border-radius:18px;box-shadow:0 18px 55px rgba(0,0,0,.20);
  padding:14px 14px 16px; position:relative; overflow:auto; -webkit-overflow-scrolling:touch;}
.scrollTop{font-weight:900;color:#c2255c;margin:0 0 8px;font-size:18px}
.scrollText{margin:0;color:#444;line-height:1.45;white-space:pre-wrap}
.drawerClose{align-self:flex-end; background:#fff0f6; border-radius:14px; font-weight:900;}
</style>
</head>

<body>
<canvas id="sparkles"></canvas>

<div class="sideLetters">
  <button class="sideBtn" data-letter="mad">mad ğŸ˜ </button>
  <button class="sideBtn" data-letter="sad">sad ğŸ˜”</button>
  <button class="sideBtn" data-letter="miss">miss ğŸ¥º</button>
</div>

<div id="drawerOverlay" class="drawerOverlay"></div>
<div id="drawer" class="drawer" aria-hidden="true">
  <button id="drawerClose" class="drawerClose">close âœ–</button>
  <div class="scrollCard">
    <div id="drawerTitle" class="scrollTop"></div>
    <p id="drawerText" class="scrollText"></p>
  </div>
</div>

<div class="wrap">
  <div class="card" id="card">
    <div id="type" class="type"></div>
    <p id="timeMsg"></p>

    <div id="dailyQuote"><b>Daily love quote ğŸ’—</b><div id="quoteText" style="margin-top:6px;"></div></div>

    <div class="row">
      <span class="pill">Hearts: <span id="heartCount">0</span> ğŸ’</span>
      <span class="pill">Paneer: <span id="paneerCount">0</span> ğŸ§€</span>
      <button id="paneerBtn" class="smallBtn" type="button">+ paneer ğŸ§€</button>

      <button id="apologyBtn" class="smallBtn" type="button">apology generator ğŸ¥º</button>
      <button id="rainBtn" class="smallBtn" type="button">rain: off ğŸŒ§ï¸</button>
      <button id="pianoBtn" class="smallBtn" type="button">piano: off ğŸ¹</button>

      <!-- NEW: theme toggle -->
      <button id="themeBtn" class="smallBtn" type="button">theme: pink ğŸ€</button>
    </div>

    <div id="apologyOut" style="margin-top:10px;color:#444;background:#f8f9fa;border-radius:14px;padding:10px;display:none;"></div>

    <button class="openBtn" id="openBtn" style="margin-top:14px;" type="button">Open the envelope ğŸ’Œ</button>
    <span class="hint">open this when youâ€™re mad at me</span>

    <div class="envelope" id="envelope">
      <div class="flap"></div>
      <div class="paper"><b>Eva & Akhil ğŸ’•</b><p style="margin:8px 0 0;">I made this for you because I love you.</p></div>
    </div>

    <div class="secret" id="secret">â€œI love you â¤ï¸ Open this when youâ€™re mad at me. I made it for you because I love you so can I have 5 diamond cartier ples dadiğŸ’—.â€</div>

    <button class="madBtn" id="madBtn" type="button">still mad? ğŸ˜ </button>

    <div class="timeline">
      <h3>Timeline of us ğŸ’</h3>
      <div class="tItem"><div class="dot"></div><div class="tText"><b>End of August:</b> we met ğŸ¥º</div></div>
      <div class="tItem"><div class="dot"></div><div class="tText"><b>Halloween:</b> we started dating ğŸƒğŸ’•</div></div>
      <div class="tItem"><div class="dot"></div><div class="tText"><b>September</b> we conquered chem building u had green new balances ğŸƒğŸ’•</div></div>
      <div class="tItem"><div class="dot"></div><div class="tText"><b>Jan 13:</b> you gave me a handmade and real bouquet ğŸ¥º</div></div>
      <div class="tItem"><div class="dot"></div><div class="tText"><b>Jan 13:</b> we made our first videooooo ğŸ˜ˆ</div></div>
    </div>

    <div class="shineBox">
      <h3>Promise list âœ¨</h3>
      <ul><li><b>I promise to always be there for you no matter what.</b></li></ul>
      <div class="small"> Many more coming </div>
    </div>

    <!-- NEW: forever quote box -->
    <div class="shineBox" style="margin-top:14px;">
      <h3>Forever â™¾ï¸</h3>
      <p style="margin:0;color:#444;line-height:1.45;">
        â€œIn every lifetime and every universe, I know youâ€™re meant to be mine,
        and no matter the lifetime or universe, I would still choose you no matter what.
        My heart would always find its way to you.â€<br>
        â€œI have a feeling we will always find our way back to each other even if we're fish or turtles or different.â€<br>
        <b>â€“ Eva to Akhil</b>
      </p>
    </div>

    <!-- Poems button section (fixed) -->
    <div style="margin-top:14px;">
      <button id="poemBtn" class="smallBtn" type="button">read my poems for you ğŸ“–ğŸ’—</button>

      <div id="poemsBox" style="display:none; margin-top:10px; background:#fff0f6; border-radius:14px; padding:12px; color:#444; text-align:left;">
        <p style="white-space:pre-wrap; line-height:1.45; margin:0;">


Things I wrote as I got to know you but never showed you: 
          
He loves paneer like itâ€™s written in his DNA,
Blocks of it vanish by the end of the day.
Milk in his fridge? A sacred supply,
Gone by morning, donâ€™t ask me why.

While others crave coffee or late-night thrills,
Heâ€™s chasing protein and calcium fills.
If love were measured in curds and spills,
Heâ€™d marry paneer and drink milk for thrills.

          

We met at the chemistry building, chemistry jokes aside,
In the building where formulas quietly hide.
Whiteboards, glass doors, that hallway hum,
I didnâ€™t know then what weâ€™d become.

Between reactions and borrowed time,
Something sparked, unplanned, sublime.
Funny how love didnâ€™t need a chart or degree,
Just one moment in chemistry, you and me.
        </p>
      </div>
    </div>

    <img id="crMeme" src="https://media.tenor.com/w2mCAR7kgUsAAAAM/clash-royale-emotes.gif" alt="clash royale laugh" style="width:140px;margin:10px auto;border-radius:12px;display:none;">
  </div>
</div>

<script>
/* Fade in */
addEventListener("load", ()=> document.body.classList.add("loaded"));

/* Typewriter */
const lines=[
  "Eva & Akhil ğŸ’",
  "I love you â¤ï¸",
  "Hiiiiiiiiiiiiiiiiiiiiiiiii baby",
  "I made this while I should be studying but I thought of u ğŸ’—",
  "This is where I will send u letters and updates on us and ill wait for u to check it always I messed up the code a little sorryğŸ’—actually im charging u 20k for this thanks goodbye and ill alwways love u remember that when u check this website spent days making it"
];
let i=0,j=0,del=false;
const el=document.getElementById("type");
(function loop(){
  el.textContent=lines[i].slice(0,del?--j:++j);
  if(!del && j===lines[i].length){ del=true; return setTimeout(loop,900); }
  if(del && j===0){ del=false; i=(i+1)%lines.length; }
  setTimeout(loop,del?25:45);
})();

/* Time message */
const hour=new Date().getHours();
document.getElementById("timeMsg").textContent =
  (hour>=5 && hour<12) ? "Good morning baby â˜€ï¸" :
  (hour>=18 || hour<5) ? "Goodnight my love ğŸŒ™" :
  "Thinking of you ğŸ’—";

/* Daily quote (added paneer joke + find our way back) */
const quotes=[
  "You are my favorite person.",
  "Iâ€™m on your team. Always.",
  "I love you in every mood.",
  "You + me = home.",
  "Even when weâ€™re annoyedâ€¦ I still choose you.",
  "Fun fact: you are 60% paneer at this point ğŸ§€ğŸ’€ (and I still love you)",
  "I have a feeling we will always find our way back to each other."
];
const todayKey=new Date().toISOString().slice(0,10);
let savedQuoteKey=localStorage.getItem("evaQuoteDay"),
    savedQuote=localStorage.getItem("evaQuoteText");
if(savedQuoteKey!==todayKey || !savedQuote){
  savedQuote=quotes[(new Date().getFullYear()*10000+((new Date().getMonth()+1)*100)+new Date().getDate())%quotes.length];
  localStorage.setItem("evaQuoteDay",todayKey);
  localStorage.setItem("evaQuoteText",savedQuote);
}
document.getElementById("quoteText").textContent=savedQuote;

/* Heart counter */
const heartCountEl=document.getElementById("heartCount");
let heartCount=Number(localStorage.getItem("evaHeartCount")||"0");
function addHearts(n){
  heartCount+=n;
  localStorage.setItem("evaHeartCount",String(heartCount));
  heartCountEl.textContent=String(heartCount);
}
heartCountEl.textContent=String(heartCount);

/* Paneer counter */
const paneerCountEl=document.getElementById("paneerCount");
const paneerBtn=document.getElementById("paneerBtn");
let paneerCount=Number(localStorage.getItem("evaPaneerCount")||"0");
function addPaneer(n){
  paneerCount+=n;
  localStorage.setItem("evaPaneerCount",String(paneerCount));
  paneerCountEl.textContent=String(paneerCount);
}
paneerCountEl.textContent=String(paneerCount);

/* Hearts floating */
const heartEmojis=["ğŸ’—","ğŸ’","ğŸ’–","ğŸ’˜","ğŸ’•","â¤ï¸"];
function spawnHeart(x,y){
  const h=document.createElement("div");
  h.className="heart";
  h.textContent=heartEmojis[(Math.random()*heartEmojis.length)|0];
  h.style.left=x+"px";
  h.style.top=y+"px";
  h.style.fontSize=(14+Math.random()*18)+"px";
  h.style.animationDuration=(3+Math.random()*3)+"s";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),6000);
}
function burstHearts(x,y,n){
  for(let k=0;k<n;k++) spawnHeart(x+(Math.random()*180-90), y+(Math.random()*80-40));
  addHearts(n);
}
setInterval(()=>{ spawnHeart(Math.random()*innerWidth, innerHeight+20); addHearts(1); },900);

/* IMPORTANT: donâ€™t burst hearts when clicking buttons (prevents interference) */
addEventListener("click",(e)=>{
  if(e.target.closest("button")) return;   // <- key fix
  if(e.target.closest("#drawer")) return;
  burstHearts(e.clientX,e.clientY,10);
},{passive:true});

/* Paneer button */
paneerBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  addPaneer(1);
  burstHearts(innerWidth/2, innerHeight/2, 6);
});

/* Envelope + secret */
const openBtn=document.getElementById("openBtn"),
      envelope=document.getElementById("envelope"),
      secret=document.getElementById("secret");
openBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  envelope.classList.add("show");
  setTimeout(()=>envelope.classList.toggle("open"),50);
  setTimeout(()=>secret.classList.toggle("show"),650);
  burstHearts(innerWidth/2,innerHeight/2,18);
});

/* Still mad */
const madBtn=document.getElementById("madBtn"),
      crMeme=document.getElementById("crMeme"),
      card=document.getElementById("card");
let mad=true;
madBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  mad=!mad;
  madBtn.textContent = mad ? "still mad? ğŸ˜ " : "I'm sorry my love. Iâ€™ll listenâ€¦ even if youâ€™re mad AND eating paneer ğŸ§€ğŸ¥º";
  madBtn.classList.toggle("love",!mad);
  card.classList.toggle("heartbeat",!mad);
  crMeme.style.display = mad ? "none" : "block";
});

/* Apology generator */
const apologyBtn=document.getElementById("apologyBtn"),
      apologyOut=document.getElementById("apologyOut");
const apologies=[
  "im sorry my love i never mean to hurt you or make you feel sad.",
  "im sorry baby. i love you and iâ€™m listening. come here ğŸ¥º",
  "im sorry my love. you matter to me more than my ego. ğŸ’—"
];
apologyBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  apologyOut.style.display="block";
  apologyOut.textContent=apologies[(Math.random()*apologies.length)|0];
});

/* Rain + Piano */
const rainBtn=document.getElementById("rainBtn");
const pianoBtn=document.getElementById("pianoBtn");

let audioCtx=null,rainOn=false,pianoOn=false,rainNode=null,rainGain=null,pianoTimer=null;

function ensureAudio(){
  if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)();
}

function startRain(){
  ensureAudio();
  const bufferSize=2*audioCtx.sampleRate;
  const noiseBuffer=audioCtx.createBuffer(1,bufferSize,audioCtx.sampleRate);
  const out=noiseBuffer.getChannelData(0);
  for(let k=0;k<bufferSize;k++) out[k]=Math.random()*2-1;

  const white=audioCtx.createBufferSource();
  white.buffer=noiseBuffer; white.loop=true;

  const filter=audioCtx.createBiquadFilter();
  filter.type="lowpass";
  filter.frequency.value=900;

  rainGain=audioCtx.createGain();
  rainGain.gain.value=0.0;

  white.connect(filter);
  filter.connect(rainGain);
  rainGain.connect(audioCtx.destination);

  white.start();
  rainNode=white;
  rainGain.gain.linearRampToValueAtTime(0.18,audioCtx.currentTime+0.6);
}
function stopRain(){
  if(rainGain) rainGain.gain.linearRampToValueAtTime(0.0,audioCtx.currentTime+0.4);
  setTimeout(()=>{
    try{ rainNode && rainNode.stop(); }catch(e){}
    rainNode=null; rainGain=null;
  },500);
}

function playPianoNote(freq,when,dur){
  const osc=audioCtx.createOscillator();
  const gain=audioCtx.createGain();
  osc.type="triangle";
  osc.frequency.value=freq;
  gain.gain.setValueAtTime(0.0001,when);
  gain.gain.exponentialRampToValueAtTime(0.08,when+0.02);
  gain.gain.exponentialRampToValueAtTime(0.0001,when+dur);
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.start(when);
  osc.stop(when+dur+0.02);
}
function startPiano(){
  ensureAudio();
  const scale=[261.63,293.66,329.63,392.00,440.00];
  let step=0;
  pianoTimer=setInterval(()=>{
    const now=audioCtx.currentTime;
    const f1=scale[step%scale.length];
    const f2=scale[(step+2)%scale.length]/2;
    playPianoNote(f1,now,0.6);
    playPianoNote(f2,now,0.8);
    step++;
  },900);
}
function stopPiano(){
  if(pianoTimer) clearInterval(pianoTimer);
  pianoTimer=null;
}

rainBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  rainOn=!rainOn;
  if(rainOn){ startRain(); rainBtn.textContent="rain: on ğŸŒ§ï¸"; }
  else{ stopRain(); rainBtn.textContent="rain: off ğŸŒ§ï¸"; }
});

pianoBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  pianoOn=!pianoOn;
  if(pianoOn){ startPiano(); pianoBtn.textContent="piano: on ğŸ¹"; }
  else{ stopPiano(); pianoBtn.textContent="piano: off ğŸ¹"; }
});

/* Side letters */
const LETTERS={
  mad:{title:"Open when mad ğŸ˜ ",text:"\n\n I love you. Iâ€™m sorry. Iâ€™m listening. I want to fix it, not fight you. ğŸ’—\n\n(alsoâ€¦ stop stress-eating paneer ğŸ§€ğŸ˜­)"},
  sad:{title:"Open when sad ğŸ˜”",text:"\n\n Come here. You donâ€™t have to carry it alone. Iâ€™m with you always. ğŸ’™"},
  miss:{title:"Open when you miss me ğŸ¥º",text:"\n\n I miss you too. Pretend this is a hug. ğŸ¥ºğŸ’—"}
};
const overlay=document.getElementById("drawerOverlay"),
      drawer=document.getElementById("drawer"),
      dTitle=document.getElementById("drawerTitle"),
      dText=document.getElementById("drawerText"),
      closeBtn=document.getElementById("drawerClose");
function openLetter(key){
  const L=LETTERS[key];
  dTitle.textContent=L.title;
  dText.textContent=L.text;
  overlay.classList.add("show");
  drawer.classList.add("show");
  drawer.setAttribute("aria-hidden","false");
}
function closeLetter(){
  drawer.classList.remove("show");
  overlay.classList.remove("show");
  drawer.setAttribute("aria-hidden","true");
}
document.querySelectorAll(".sideBtn").forEach(b=>b.addEventListener("click",(e)=>{ e.stopPropagation(); openLetter(b.dataset.letter); }));
overlay.addEventListener("click",closeLetter);
closeBtn.addEventListener("click",closeLetter);

/* Poems toggle (SAFE + wonâ€™t crash) */
addEventListener("load", () => {
  const poemBtn = document.getElementById("poemBtn");
  const poemsBox = document.getElementById("poemsBox");
  if(!poemBtn || !poemsBox) return;

  poemBtn.addEventListener("click",(e)=>{
    e.stopPropagation();
    const open = getComputedStyle(poemsBox).display !== "none";
    poemsBox.style.display = open ? "none" : "block";
    poemBtn.textContent = open ? "read my poems for you ğŸ“–ğŸ’—" : "close poems ğŸ«¶";
    burstHearts(innerWidth/2, innerHeight/2, 10);
  });
});

/* Theme toggle (NEW) */
const themeBtn = document.getElementById("themeBtn");
const themes = [
  {name:"pink",     bg:"#ffe6f0", label:"theme: pink ğŸ€"},
  {name:"lavender", bg:"#efe6ff", label:"theme: lavender ğŸ’œ"},
  {name:"sky",      bg:"#e6f3ff", label:"theme: sky ğŸ’™"},
  {name:"mint",     bg:"#e6fff2", label:"theme: mint ğŸ’š"},
];
let themeIndex = Number(localStorage.getItem("evaThemeIndex")||"0");
function applyTheme(idx){
  themeIndex = idx % themes.length;
  document.body.style.background = themes[themeIndex].bg;
  themeBtn.textContent = themes[themeIndex].label;
  localStorage.setItem("evaThemeIndex", String(themeIndex));
}
applyTheme(themeIndex);

themeBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  applyTheme(themeIndex+1);
  burstHearts(innerWidth/2, innerHeight/2, 12);
});

/* Sparkles cursor */
const c=document.getElementById("sparkles"),
      ctx=c.getContext("2d");
let W,H;
function resize(){ W=c.width=innerWidth; H=c.height=innerHeight; }
addEventListener("resize",resize); resize();

const p=[];
function addSparkle(x,y){
  for(let k=0;k<3;k++){
    p.push({x,y,vx:(Math.random()*2-1)*1.8,vy:(Math.random()*2-1)*1.8,life:1,r:1+Math.random()*2.2});
  }
}
addEventListener("mousemove",e=>addSparkle(e.clientX,e.clientY),{passive:true});

(function draw(){
  ctx.clearRect(0,0,W,H);
  for(let k=p.length-1;k>=0;k--){
    const s=p[k];
    s.x+=s.vx; s.y+=s.vy; s.vy+=0.03; s.life-=0.03;
    if(s.life<=0){ p.splice(k,1); continue; }
    ctx.globalAlpha=Math.max(s.life,0);
    ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
    ctx.fillStyle="white"; ctx.fill();
  }
  ctx.globalAlpha=1;
  requestAnimationFrame(draw);
})();
</script>
</body>
</html>
